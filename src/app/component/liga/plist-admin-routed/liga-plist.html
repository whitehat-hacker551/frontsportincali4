<div class="container my-2">
    <div class="d-flex justify-content-center my-3">
        <h1>Mantenimiento de Liga</h1>
    </div>

    <!-- Búsqueda por nombre usando debounce -->
    @if (equipo() <= 0) { <div class="d-flex justify-content-center my-2">
        <input class="form-control me-2" type="search" placeholder="Buscar por nombre" aria-label="Search"
            (input)="onSearchName($event.target.value)" [value]="nombre()" name="searchName" />
</div>
}

<!-- Total registros -->
<div class="d-flex justify-content-center my-1">
    <small class="text-muted">Total registros: {{ totalElementsCount() }}</small>
    @if (equipo() > 0) {
    <small class="text-muted ms-3">Filtro: id de equipo = {{ equipo() }}</small>
    <!-- quitar el filtro -->
    <a class="ms-2" [routerLink]="['/liga']" role="button" title="Quitar filtro"><i class="bi bi-x-lg"
            aria-hidden="true"></i> Quitar filtro</a>
    }
    @if (nombre().length > 0) {
    <small class="text-muted ms-3">Filtro: nombre contiene "{{ nombre() }}"</small>
    }
</div>

<div class="d-flex justify-content-between my-1" [hidden]="totalElementsCount() === 0">
    <app-paginacion [numPage]="numPage()" [numPages]="oPage()?.totalPages || 1" (pageChange)="goToPage($event)">
    </app-paginacion>

    <app-botonera-rpp [numRpp]="numRpp()" (rppChange)="onRppChange($event)"> </app-botonera-rpp>
</div>

<div class="d-flex justify-content-center" [hidden]="totalElementsCount() === 0">
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th scope="col" (click)="onOrder('id')" style="cursor: pointer; width: 10%">
                    <span class="header-inline">ID @if (orderField() === 'id') { @if (orderDirection() === 'asc') {
                        <i class="bi bi-caret-up-fill ms-1" aria-hidden="true"></i>
                        } @if (orderDirection() === 'desc') {
                        <i class="bi bi-caret-down-fill ms-1" aria-hidden="true"></i>
                        } }
                    </span>
                </th>
                <th scope="col" (click)="onOrder('nombre')" style="cursor: pointer; width: 50%">
                    <span class="header-inline">Nombre @if (orderField() === 'nombre') { @if (orderDirection() ===
                        'asc') {
                        <i class="bi bi-caret-up-fill ms-1" aria-hidden="true"></i>
                        } @if (orderDirection() === 'desc') {
                        <i class="bi bi-caret-down-fill ms-1" aria-hidden="true"></i>
                        } }
                    </span>
                </th>
                <th scope="col" (click)="onOrder('equipo.id')" style="cursor: pointer; width: 40%">
                    <span class="header-inline">Equipo @if (orderField() === 'equipo.id') { @if (orderDirection() ===
                        'asc') {
                        <i class="bi bi-caret-up-fill ms-1" aria-hidden="true"></i>
                        } @if (orderDirection() === 'desc') {
                        <i class="bi bi-caret-down-fill ms-1" aria-hidden="true"></i>
                        } }</span>
                </th>
                <th scope="col" (click)="onOrder('partidos')" style="cursor: pointer; width: 40%">
                    <span class="header-inline">Partido @if (orderField() === 'partidos') { @if (orderDirection() ===
                        'asc') {
                        <i class="bi bi-caret-up-fill ms-1" aria-hidden="true"></i>
                        } @if (orderDirection() === 'desc') {
                        <i class="bi bi-caret-down-fill ms-1" aria-hidden="true"></i>
                        } }</span>
                </th>
                <th scope="col">
                    <span class="header-inline">Acciones </span>
                </th>
            </tr>
        </thead>
        <tbody>
            @for (oLiga of oPage()?.content; track oLiga.id ) {
            <tr>
                <th scope="row">{{ oLiga.id }}</th>
                <td>{{ oLiga.nombre }}</td>
                <td>
                    <a [routerLink]="['/liga/view', oLiga.id]">
                        {{ oLiga.equipo.nombre }}
                        {{ ' (' + oLiga.equipo.id + ')' }}
                    </a>
                    <!-- Botón alineado a la derecha para filtrar equipo -->
                    <a class="btn btn-warning btn-sm ms-2 float-end" [routerLink]="['/liga', oLiga.equipo.id]"
                        role="button" title="Editar"><i class="bi bi-funnel-fill" aria-hidden="true"></i></a>
                </td>
                <td style="text-align: center">
                    @if (oLiga.partidos === 0) {
                    <i class="bi bi-ban" aria-hidden="true"></i>
                    } @else {
                    <a [routerLink]="['/partido', oLiga.id]">
                        {{ oLiga.partidos }}
                    </a>
                    }
                </td>
                <td>
                    <div class="d-flex justify-content-center">
                        <div class="btn-group btn-group-sm" role="group" aria-label="Small button group">
                            <a class="btn btn-primary btn-sm" [routerLink]="['/liga/view', oLiga.id]" role="button"
                                title="Ver"><i class="bi bi-eye" aria-hidden="true"></i></a>
                            <a class="btn btn-warning btn-sm" [routerLink]="['/liga/edit', oLiga.id]" role="button"
                                title="Editar"><i class="bi bi-pencil" aria-hidden="true"></i></a>
                            <a class="btn btn-danger btn-sm" [routerLink]="['/liga/delete', oLiga.id]" role="button"
                                title="Eliminar"><i class="bi bi-trash" aria-hidden="true"></i></a>
                        </div>
                    </div>
                </td>
            </tr>
            }
        </tbody>
    </table>
</div>
@if (totalElementsCount() === 0) {
<div class="d-flex justify-content-center my-4">
    <div class="alert alert-secondary text-center w-100" style="max-width: 720px">
        <h5 class="mb-1">No hay ligas</h5>
        <p class="small mb-2">No hay registros para mostrar en este momento.</p>
    </div>
</div>
}
</div>